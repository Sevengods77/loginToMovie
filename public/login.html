<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign In â€“ NETMOVIE</title>
    <meta name="description" content="Sign in to NETMOVIE and stream unlimited movies and shows." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
</head>

<body class="auth-page">

    <!-- â•â• Glassmorphic Scene â€” vivid orbs are what make glass visible â•â• -->
    <div class="scene">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
        <div class="orb orb-4"></div>
        <div class="orb orb-5"></div>
    </div>

    <!-- Red film strip at bottom -->
    <div class="film-strip"></div>

    <!-- NETMOVIE Brand Header (glass bar) -->
    <header class="brand">
        <div class="brand-logo"><span class="logo-n">N</span>ETMOVIE</div>
    </header>

    <!-- Main Page -->
    <main class="page-wrapper">
        <div class="card" id="mainCard">

            <!-- Card Header -->
            <div class="card-header" id="cardHeader">
                <h1 class="card-title">Welcome Back</h1>
                <p class="card-subtitle">Sign in to continue watching</p>
            </div>

            <!-- Success Overlay -->
            <div class="success-overlay" id="successOverlay">
                <div class="success-icon">ðŸŽ¬</div>
                <h2 class="success-title" id="successTitle">Welcome back!</h2>
                <p class="success-msg">Loading your movies...</p>
                <div class="redirect-bar">
                    <div class="redirect-progress" id="redirectProgress"></div>
                </div>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="form" novalidate>

                <!-- Username -->
                <div class="form-group" id="group-user_name">
                    <label class="form-label" for="user_name">
                        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="8" r="4" />
                            <path d="M4 20c0-4 3.6-7 8-7s8 3 8 7" />
                        </svg>
                        User ID or Username
                    </label>
                    <input type="text" id="user_name" name="user_name" class="form-input"
                        placeholder="Enter your User ID (e.g. netm01)" autocomplete="username" required />
                    <span class="field-error" id="err-user_name"></span>
                </div>

                <!-- Password -->
                <div class="form-group" id="group-password">
                    <label class="form-label" for="password">
                        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="11" width="18" height="11" rx="2" />
                            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                        </svg>
                        Password
                    </label>
                    <div class="input-wrapper">
                        <input type="password" id="password" name="password" class="form-input"
                            placeholder="Enter your password" autocomplete="current-password" required />
                        <button type="button" class="toggle-pw" id="togglePw" aria-label="Toggle password visibility">
                            <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                        </button>
                    </div>
                    <span class="field-error" id="err-password"></span>
                </div>

                <!-- Alert -->
                <div class="alert" id="formAlert" style="display:none;"></div>

                <!-- Submit -->
                <button type="submit" class="btn-primary" id="submitBtn">
                    <span class="btn-text">Sign In</span>
                    <span class="btn-loader" id="btnLoader">
                        <span class="spinner"></span> Signing in...
                    </span>
                </button>
            </form>

            <!-- Card Footer -->
            <div class="card-footer" id="cardFooter">
                New to NETMOVIE? <a href="/register" class="link">Create an account</a>
            </div>

        </div>
    </main>

    <footer class="page-footer">Â© 2026 NETMOVIE. All rights reserved.</footer>

    <script>
        // â”€â”€ Toggle Password â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const pwInput = document.getElementById('password');
        const eyeIcon = document.getElementById('eyeIcon');

        document.getElementById('togglePw').addEventListener('click', () => {
            const isHidden = pwInput.type === 'password';
            pwInput.type = isHidden ? 'text' : 'password';
            eyeIcon.innerHTML = isHidden
                ? '<path d="M17.94 17.94A10 10 0 0 1 12 20c-7 0-11-8-11-8a18 18 0 0 1 5.06-5.94"/><path d="M9.9 4.24A9 9 0 0 1 12 4c7 0 11 8 11 8a18 18 0 0 1-2.16 3.19"/><line x1="1" y1="1" x2="23" y2="23"/>'
                : '<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>';
        });

        // â”€â”€ Form Submit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            clearErrors();

            const login_id = document.getElementById('user_name').value.trim();
            const login_pw = document.getElementById('password').value;

            let valid = true;
            if (!login_id) { showError('user_name', 'Enter your User ID or Username'); valid = false; }
            if (!login_pw) { showError('password', 'Enter your password'); valid = false; }
            if (!valid) return;

            setLoading(true);
            try {
                const res = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ login_input: login_id, password: login_pw }) // mapped to login_input for server
                });
                const data = await res.json();

                if (data.success) {
                    document.getElementById('loginForm').style.display = 'none';
                    document.getElementById('cardFooter').style.display = 'none';
                    document.getElementById('cardHeader').style.display = 'none';
                    const overlay = document.getElementById('successOverlay');
                    document.getElementById('successTitle').textContent = data.message;
                    overlay.style.display = 'flex';
                    const bar = document.getElementById('redirectProgress');
                    bar.style.transition = 'width 2.5s ease';
                    setTimeout(() => { bar.style.width = '100%'; }, 50);
                    setTimeout(() => { window.location.href = data.redirect; }, 2700);
                } else {
                    showAlert(data.message, 'error');
                    document.getElementById('mainCard').classList.add('shake');
                    setTimeout(() => document.getElementById('mainCard').classList.remove('shake'), 600);
                }
            } catch {
                showAlert('Network error. Please check your connection.', 'error');
            } finally {
                setLoading(false);
            }
        });

        function clearErrors() {
            document.querySelectorAll('.field-error').forEach(el => el.textContent = '');
            document.querySelectorAll('.form-input').forEach(el => el.classList.remove('input-error'));
            document.getElementById('formAlert').style.display = 'none';
        }
        function showError(id, msg) {
            document.getElementById(`err-${id}`).textContent = msg;
            document.getElementById(id).classList.add('input-error');
        }
        function showAlert(msg, type) {
            const a = document.getElementById('formAlert');
            a.textContent = msg; a.className = `alert alert-${type}`; a.style.display = 'block';
        }
        function setLoading(on) {
            const btn = document.getElementById('submitBtn');
            btn.disabled = on;
            btn.querySelector('.btn-text').style.display = on ? 'none' : 'inline';
            document.getElementById('btnLoader').style.display = on ? 'flex' : 'none';
        }
    </script>
</body>

</html>